import Global from '/docs/cmd/_global.mdx';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# exchange role assignment add

Add a role assignment to a role assignment policy

## Usage

```sh
m365 exchange role assignment add [options]
```

## Options

```md definition-list
`--roleDefinitionId [roleDefinitionId]`
: Id of a role to be assigned. Specify either `roleDefinitionId` or `roleDefinitionName`, but not both.

`--roleDefinitionName [roleDefinitionName]`
: Name of a role to be assigned. Specify either `roleDefinitionId` or `roleDefinitionName`, but not both.

`--principalId [principalId]`
: Id of a service principal to which the assignment is granted. Specify either `principalId` or `principalName`, but not both.

`--principalName [principalName]`
: Name of a service principal to which the assignment is granted. Specify either `principalId` or `principalName`, but not both.

`--scopeUserId [scopeUserId]`
: Id of a user to which the assignment is scoped. Specify either `scopeTenant`, `scopeUserId`, `scopeUserName`, `scopeGroupId`, `scopeGroupName`, `scopeAdministrativeUnitId`, or `scopeAdministrativeUnitName`, but not multiple.

`--scopeUserName [scopeUserName]`
: UPN of a user to which the assignment is scoped. Specify either `scopeTenant`, `scopeUserId`, `scopeUserName`, `scopeGroupId`, `scopeGroupName`, `scopeAdministrativeUnitId`, or `scopeAdministrativeUnitName`, but not multiple.

`--scopeGroupId [scopeGroupId]`
: Id of a group to which the assignment is scoped. Specify either `scopeTenant`, `scopeUserId`, `scopeUserName`, `scopeGroupId`, `scopeGroupName`, `scopeAdministrativeUnitId`, or `scopeAdministrativeUnitName`, but not multiple.

`--scopeGroupName [scopeGroupName]`
: Name of a group to which the assignment is scoped. Specify either `scopeTenant`, `scopeUserId`, `scopeUserName`, `scopeGroupId`, `scopeGroupName`, `scopeAdministrativeUnitId`, or `scopeAdministrativeUnitName`, but not multiple.

`--scopeAdministrativeUnitId [scopeAdministrativeUnitId]`
: Id of an administrative unit to which the assignment is scoped. Specify either `scopeTenant`, `scopeUserId`, `scopeUserName`, `scopeGroupId`, `scopeGroupName`, `scopeAdministrativeUnitId`, or `scopeAdministrativeUnitName`, but not multiple.

`--scopeAdministrativeUnitName [scopeAdministrativeUnitName]`
: Name of an administrative unit to which the assignment is scoped. Specify either `scopeTenant`, `scopeUserId`, `scopeUserName`, `scopeGroupId`, `scopeGroupName`, `scopeAdministrativeUnitId`, or `scopeAdministrativeUnitName`, but not multiple.

`--scopeTenant`
: Specify whether the tenant-wide scope is applied. Specify either `scopeTenant`, `scopeUserId`, `scopeUserName`, `scopeGroupId`, `scopeGroupName`, `scopeAdministrativeUnitId`, or `scopeAdministrativeUnitName`, but not multiple.
```

<Global />

## Remarks

:::info

To use this command you must be at least **Privileged Role Administrator**.

:::

## Examples

Assign a role specified by id to a service principal specified by id and scope the assignment to the whole tenant

```sh
m365 exchange role assignment add --roleDefinitionId 777b752-f9b7-4205-a2b1-5db0d6a0ccfc --principalId 7a2ca997-9461-402e-9882-58088a370889 --scopeTenant
```

Assign a role specified by id to a service principal specified by id and scope the assignment to a user specified by id

```sh
m365 exchange role assignment add --roleDefinitionId 777b752-f9b7-4205-a2b1-5db0d6a0ccfc --principalId 7a2ca997-9461-402e-9882-58088a370889 --scopeUserId a4738dd8-fc0f-4646-87fb-47539f5c651b
```

Assign a role specified by name to a service principal specified by name and scope the assignment to a group specified by name

```sh
m365 exchange role assignment add --roleDefinitionName 'Application Contacts.ReadWrite' --principalName 'ContactsSyncApp' --scopeGroupName 'Marketing'
```

Assign a role specified by name to a service principal specified by id and scope the assignment to an administrative unit specified by name

```sh
m365 exchange role assignment add --roleDefinitionName 'Application Calendars.Read' --principalId fa631c4d-ac9f-4884-a7f5-13c659d177e3 --scopeAdministrativeUnitName 'Equipment - EMEA'
```

## Response

<Tabs>
  <TabItem value="JSON">

  ```json
  {
    "id": "6615d221-3834-4f8f-bbc9-7d0d23620a8e",
    "principalId": "/ServicePrincipals/e483a0d9-8440-455e-8f9a-b9cac6b8b0ef",
    "roleDefinitionId": "1f704712-7d46-481f-b2cd-dbcc978c4f2a",
    "directoryScopeId": "/",
    "appScopeId": null
  }
  ```

  </TabItem>
  <TabItem value="Text">

  ```text
  appScopeId      : null
  directoryScopeId: /
  id              : 6615d221-3834-4f8f-bbc9-7d0d23620a8e
  principalId     : /ServicePrincipals/e483a0d9-8440-455e-8f9a-b9cac6b8b0ef
  roleDefinitionId: 1f704712-7d46-481f-b2cd-dbcc978c4f2a
  ```

  </TabItem>
  <TabItem value="CSV">

  ```csv
  id,principalId,roleDefinitionId,directoryScopeId,appScopeId
  6615d221-3834-4f8f-bbc9-7d0d23620a8e,/ServicePrincipals/e483a0d9-8440-455e-8f9a-b9cac6b8b0ef,1f704712-7d46-481f-b2cd-dbcc978c4f2a,/,
  ```

  </TabItem>
  <TabItem value="Markdown">

  ```md
  # exchange role assignment add --debug "false" --verbose "false" --roleDefinitionId "1f704712-7d46-481f-b2cd-dbcc978c4f2a" --principalId "e483a0d9-8440-455e-8f9a-b9cac6b8b0ef" --scopeTenant true

  Date: 10/3/2024

  ## 6615d221-3834-4f8f-bbc9-7d0d23620a8e

  Property | Value
  ---------|-------
  id | 6615d221-3834-4f8f-bbc9-7d0d23620a8e
  principalId | /ServicePrincipals/e483a0d9-8440-455e-8f9a-b9cac6b8b0ef
  roleDefinitionId | 1f704712-7d46-481f-b2cd-dbcc978c4f2a
  directoryScopeId | /
  ```

  </TabItem>
</Tabs>

## More information

- Role assignment: https://learn.microsoft.com/graph/api/rbacapplication-post-roleassignments?view=graph-rest-beta
