import Global from '/docs/cmd/_global.mdx';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# graph openextension set

Updates an open extension for a resource

## Usage

```sh
m365 graph openextension set [options]
```

## Options

```md definition-list
`-n, --name <name>`
: The name of the open extension.

`-i, --resourceId <resourceId>`
: The Id of the resource for which to update the open extension.

`-t, --resourceType <resourceType>`
: The type of resource. Allowed values are `user`, `group`, `device`, `organization`.

`-r, --removePropertyIfEmpty`
: Whether the property should be removed from the open extension.
```

<Global />

## Remarks

This command allows using unknown options to update custom data of the open extension.

When updating an open extension to a user, it's possible to use the UPN as the resourceId.

:::warning[Escaping JSON in PowerShell]

When updating open extensions it's possible to enter a JSON string. In PowerShell 5 to 7.2 [specific escaping rules](./../../../user-guide/using-cli.mdx#escaping-double-quotes-in-powershell) apply due to an issue. Remember that you can also use [file tokens](./../../../user-guide/using-cli.mdx#passing-complex-content-into-cli-options) instead.

:::

:::info

If a property of the open extesion is not specified, it remains unchanged.

If the value of the property is set to an empty string and `removePropertyIfEmpty` is specified, the property will be removed from the open extension. If `removePropertyIfEmpty` is not specified, the value of the property will be cleared.

:::

## Examples

Updates an open extension for a user specified by id

```sh
m365 graph openextension set --userId eb77fbcf-6fe8-458b-985d-1747284793bc --name 'com.contoso.roamingSettings' --resourceType user --theme dark --color red --language English
```

Updates an open extension for a user specified by UPN

```sh
m365 graph openextension set --userName john.doe@contoso.com --name 'com.contoso.roamingSettings' --resourceType user --theme dark --color red --language English
```

Updates an open extension for a group specified by id, one of the property represents a JSON object

```sh
m365 graph openextension set --resourceId c956e711-f074-40c3-8431-fbd69bb67d9c --name 'com.contoso.roamingSettings' --resourceType group --settings '{"theme": "dark", "color": "red" }'
```

Removes the property from an open extension

```sh
m365 graph openextension set --userId eb77fbcf-6fe8-458b-985d-1747284793bc --name 'com.contoso.roamingSettings' --resourceType user --theme "" --removePropertyIfEmpty
```

Clears the value of the property

```sh
m365 graph openextension set --userId eb77fbcf-6fe8-458b-985d-1747284793bc --name 'com.contoso.roamingSettings' --resourceType user --theme ""
```

## Response

The command won't return a response on success.

## More information

- Open extensions: https://learn.microsoft.com/graph/extensibility-overview?tabs=http#open-extensions
